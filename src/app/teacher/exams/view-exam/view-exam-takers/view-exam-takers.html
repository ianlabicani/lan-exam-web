@if(loading()){
<div class="p-10 text-center text-gray-500">Loading...</div>
} @else { @if(!exam()){
<div class="p-10 text-center">
  <p class="text-gray-600 font-medium mb-2">Exam not found</p>
  <a routerLink="/teacher/exams" class="text-sm text-blue-600 hover:underline"
    >Return</a
  >
</div>
} @else {
<div class="container mx-auto mt-8 space-y-6">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-xl font-semibold text-gray-900">
        Exam Takers – {{ exam()?.title }}
      </h1>
      <p class="text-xs text-gray-500">Attempts: {{ takers().length }}</p>
    </div>
    <a
      [routerLink]="['/teacher/exams/view-exam', exam()!.id]"
      class="px-3 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-sm font-medium"
      >Back to Exam</a
    >
  </div>

  @if(takers().length === 0){
  <div class="p-8 text-center bg-white border rounded-lg text-gray-500 text-sm">
    No attempts yet.
  </div>
  } @else {
  <div class="overflow-x-auto bg-white border rounded-lg">
    <table class="min-w-full text-sm">
      <thead class="bg-gray-50 text-xs uppercase tracking-wide text-gray-600">
        <tr>
          <th class="text-left px-4 py-2 font-semibold">Student</th>
          <th class="text-left px-4 py-2 font-semibold">Started</th>
          <th class="text-left px-4 py-2 font-semibold">Submitted</th>
          <th class="text-left px-4 py-2 font-semibold">Status</th>
        </tr>
      </thead>
      <tbody>
        @for(t of takers(); track t.id){
        <tr class="border-t">
          <td class="px-4 py-2">
            <div class="font-medium text-gray-800">
              {{ t.user.name || t.user_id }}
            </div>
            <div class="text-[11px] text-gray-500">
              {{ t.user.year }} - {{ t.user.section | uppercase }}
            </div>
          </td>
          <td class="px-4 py-2 text-gray-600">
            {{ t.started_at | date:'short' }}
          </td>
          <td class="px-4 py-2 text-gray-600">
            @if(t.submitted_at){ {{ t.submitted_at | date:'short' }} } @else
            {<span class="text-xs text-gray-400">—</span>}
          </td>
          <td class="px-4 py-2">
            @if(t.submitted_at){<span
              class="px-2 py-0.5 rounded-full bg-green-100 text-green-700 text-[11px] font-medium"
              >Submitted</span
            >} @else {<span
              class="px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 text-[11px] font-medium"
              >In Progress</span
            >}
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  }
</div>
} }
