@if (isModalOpen()) {
  <div class="fixed inset-0 bg-gray-900/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-6 relative">
      <button class="absolute top-3 right-3 text-gray-500 hover:text-gray-700" (click)="closeModal.emit()">âœ•</button>
      <h2 class="text-xl font-semibold mb-4">Add Short Answer</h2>

      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Question</label>
          <textarea formControlName="question" class="w-full rounded-lg border border-gray-300 p-2 mt-1 focus:ring focus:ring-blue-300 focus:outline-none" rows="3"></textarea>
          @if (form.get('question')?.invalid && form.get('question')?.touched) {
            <p class="text-red-500 text-sm mt-1">Question is required (min 3 chars).</p>
          }
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Expected Answer</label>
          <input type="text" formControlName="expected_answer" class="w-full rounded-lg border border-gray-300 p-2 mt-1 focus:ring focus:ring-blue-300 focus:outline-none" />
          @if (form.get('expected_answer')?.invalid && form.get('expected_answer')?.touched) {
            <p class="text-red-500 text-sm mt-1">Expected answer is required.</p>
          }
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Points</label>
          <input type="number" formControlName="points" class="w-full rounded-lg border border-gray-300 p-2 mt-1 focus:ring focus:ring-blue-300 focus:outline-none" />
          @if (form.get('points')?.invalid && form.get('points')?.touched) {
            <p class="text-red-500 text-sm mt-1">Must be at least 1 point.</p>
          }
        </div>

        @if (errorMessage()) { <div class="text-sm text-red-600">{{ errorMessage() }}</div> }

        <div class="flex justify-end space-x-2 pt-4">
          <button type="button" (click)="closeModal.emit()" class="px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300">Cancel</button>
          <button type="submit" [disabled]="form.invalid || isSaving()" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50">
            @if (!isSaving()) { <span>Save</span> } @else { <span>Saving...</span> }
          </button>
        </div>
      </form>
    </div>
  </div>
}
