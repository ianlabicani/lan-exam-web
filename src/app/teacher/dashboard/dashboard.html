<div class="space-y-10 container mx-auto py-8 px-5">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-bold text-gray-900 tracking-tight">Teacher Dashboard</h1>
      <p class="text-sm text-gray-500 mt-1">Monitor exams, progress, and recent activity</p>
    </div>
    <a
      routerLink="/teacher/exams/create"
      class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold hover:from-blue-700 hover:to-indigo-700 transition-all shadow-md"
    >
      <fa-icon [icon]="faPlus" />
      New Exam
    </a>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-6">
    <div class="bg-white/70 backdrop-blur-md rounded-xl p-5 border border-gray-100 shadow-md hover:shadow-lg transition">
      <p class="text-xs font-medium text-gray-500 mb-1">Total Exams</p>
      <p class="text-3xl font-bold text-gray-800">{{ totalExams() }}</p>
    </div>
    <div class="bg-white/70 backdrop-blur-md rounded-xl p-5 border border-gray-100 shadow-md hover:shadow-lg transition">
      <p class="text-xs font-medium text-gray-500 mb-1">Active</p>
      <p class="text-3xl font-bold text-blue-600">{{ activeExams() }}</p>
    </div>
    <div class="bg-white/70 backdrop-blur-md rounded-xl p-5 border border-gray-100 shadow-md hover:shadow-lg transition">
      <p class="text-xs font-medium text-gray-500 mb-1">Published</p>
      <p class="text-3xl font-bold text-green-600">{{ publishedExams() }}</p>
    </div>
    <div class="bg-white/70 backdrop-blur-md rounded-xl p-5 border border-gray-100 shadow-md hover:shadow-lg transition">
      <p class="text-xs font-medium text-gray-500 mb-1">Drafts</p>
      <p class="text-3xl font-bold text-gray-700">{{ draftExams() }}</p>
    </div>
    <div class="bg-white/70 backdrop-blur-md rounded-xl p-5 border border-gray-100 shadow-md hover:shadow-lg transition">
      <p class="text-xs font-medium text-gray-500 mb-1">Avg Completion</p>
      <p class="text-3xl font-bold text-emerald-600">{{ completionRate() }}%</p>
    </div>
  </div>

  <div class="grid grid-cols-1 xl:grid-cols-3 gap-8">
    <!-- Exams Progress -->
    <div class="xl:col-span-2 space-y-6">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
          <fa-icon [icon]="faChartLine" class="text-blue-600" />
          Exam Progress
        </h2>
        <a routerLink="/teacher/exams" class="text-sm text-blue-600 hover:underline">View all</a>
      </div>

      <div class="space-y-4">
        @for(exam of exams(); track exam.id){
        <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm hover:shadow-md transition">
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1 min-w-0">
              <div class="flex items-center gap-2 mb-1">
                <h3 class="font-semibold text-gray-900 truncate">{{ exam.title }}</h3>
                <span
                  class="text-[10px] px-2 py-0.5 rounded-full font-semibold tracking-wide uppercase {{ statusBadge(exam.status) }}"
                  >{{ exam.status }}</span
                >
              </div>
              <p class="text-xs text-gray-500">
                @if(exam.status === 'active'){ Running now } @else if(exam.status === 'published'){ Scheduled }
                @else if(exam.status === 'draft'){ Not published } @else { Completed }
              </p>
            </div>
            <div class="text-right">
              <p class="text-sm font-semibold text-gray-800">{{ exam.submissions }}/{{ exam.totalStudents }}</p>
              <p class="text-[11px] text-gray-500">Submissions</p>
            </div>
          </div>
          <div class="mt-4">
            <div class="flex justify-between text-[11px] font-medium text-gray-500 mb-1">
              <span>Progress</span>
              <span>{{ progressPercent(exam) }}%</span>
            </div>
            <div class="h-2 bg-gray-100 rounded-full overflow-hidden">
              <div
                class="h-full bg-gradient-to-r from-blue-500 to-indigo-600 transition-all"
                [style.width]="progressPercent(exam)+'%'"
              ></div>
            </div>
          </div>
          <div class="mt-3 flex items-center text-[11px] text-gray-500 gap-3">
            @if(exam.startsAt){<span><fa-icon [icon]="faClock" /> Starts {{ exam.startsAt | date:'short' }}</span>}
            @if(exam.endsAt){<span><fa-icon [icon]="faFlagCheckered" /> Ends {{ exam.endsAt | date:'short' }}</span>}
          </div>
        </div>
        }
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="space-y-6">
      <h2 class="text-lg font-semibold text-gray-900 flex items-center gap-2">
        <fa-icon [icon]="faClockRotateLeft" class="text-gray-600" />
        Recent Activity
      </h2>

      <div class="bg-white border border-gray-100 rounded-xl divide-y divide-gray-100 shadow-sm">
  @for (act of recentActivity(); track act.id) {
  <div class="p-4 flex items-start gap-3 hover:bg-gray-50 transition">
    <!-- Icon -->
    <div
      class="w-10 h-10 rounded-lg flex items-center justify-center"
      [class.bg-blue-50]="act.type === 'submission'"
      [class.text-blue-600]="act.type === 'submission'"
      [class.bg-green-50]="act.type === 'published'"
      [class.text-green-600]="act.type === 'published'"
      [class.bg-amber-50]="act.type === 'graded'"
      [class.text-amber-600]="act.type === 'graded'"
      [class.bg-gray-50]="act.type !== 'submission' && act.type !== 'published' && act.type !== 'graded'"
      [class.text-gray-600]="act.type !== 'submission' && act.type !== 'published' && act.type !== 'graded'"
    >
      <fa-icon
        [icon]="
          act.type === 'submission'
            ? faPaperPlane
            : act.type === 'published'
            ? faUpload
            : act.type === 'graded'
            ? faCheckCircle
            : faPen
        "
        class="text-lg"
      />
    </div>

    <!-- Activity Description -->
    <div class="flex-1 min-w-0">
      <p class="text-sm text-gray-700">
        @if (act.type === 'submission') {
        <span><b>{{ act.student }}</b> submitted <b>{{ act.exam }}</b></span>
        } @else if (act.type === 'published') {
        <span>Published <b>{{ act.exam }}</b></span>
        } @else if (act.type === 'graded') {
        <span>Graded <b>{{ act.student }}</b>'s work for <b>{{ act.exam }}</b></span>
        } @else {
        <span>Updated <b>{{ act.exam }}</b></span>
        }
      </p>
      <p class="text-[11px] text-gray-500 mt-1">
        {{ act.time | date: 'shortTime' }} â€¢ {{ act.time | date: 'mediumDate' }}
      </p>
    </div>
  </div>
  }
</div>


      <!-- Quick Actions -->
      <div class="bg-white border border-gray-100 rounded-xl p-5 shadow-sm">
        <h3 class="text-sm font-semibold text-gray-800 mb-4 flex items-center gap-2">
          <fa-icon [icon]="faBolt" class="text-yellow-500" /> Quick Actions
        </h3>
        <div class="grid grid-cols-2 gap-3 text-sm">
          <a
            routerLink="/teacher/exams/create"
            class="flex items-center gap-2 px-3 py-2 rounded-md bg-blue-50 text-blue-700 hover:bg-blue-100 font-medium"
          >
            <fa-icon [icon]="faPlus" /> Create Exam
          </a>
          <a
            routerLink="/teacher/exams"
            class="flex items-center gap-2 px-3 py-2 rounded-md bg-gray-50 text-gray-700 hover:bg-gray-100 font-medium"
          >
            <fa-icon [icon]="faClipboardList" /> Manage Exams
          </a>
          <button
            class="flex items-center gap-2 px-3 py-2 rounded-md bg-emerald-50 text-emerald-700 hover:bg-emerald-100 font-medium"
          >
            <fa-icon [icon]="faCheckCircle" /> Grade Work
          </button>
          <button
            class="flex items-center gap-2 px-3 py-2 rounded-md bg-purple-50 text-purple-700 hover:bg-purple-100 font-medium"
          >
            <fa-icon [icon]="faCalendarDays" /> Schedule
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
